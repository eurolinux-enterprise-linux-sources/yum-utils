--- a/plugins/security/security.py    2014-08-11 16:16:19.000000000 +0200
+++ b/plugins/security/security.py       2015-02-12 18:37:08.960755794 +0100
@@ -729,24 +729,17 @@ def exclude_hook(conduit):
     opts.sec_cmds = []
     used_map = ysp_gen_used_map(opts)
 
-    # The official API is:
-    #
-    # pkgs = conduit.getPackages()
-    #
-    # ...however that is _extremely_ slow, deleting all packages. So we ask
-    # for the list of update packages, which is all we care about.    
     upds = conduit._base.doPackageLists(pkgnarrow='updates')
-    pkgs = upds.updates
+    tot = len(upds.updates)
     # In theory we don't need to do this in some cases, but meh.
     upds = conduit._base.doPackageLists(pkgnarrow='obsoletes')
-    pkgs += upds.obsoletes
+    tot += len(upds.obsoletes)
 
+    pkgs = conduit.getPackages()
     name2tup = _get_name2oldpkgtup(conduit._base)
     
-    tot = 0
     cnt = 0
     for pkg in pkgs:
-        tot += 1
         name = pkg.name
         if (name not in name2tup or
             not ysp_should_keep_pkg(opts, name2tup[name], md_info, used_map)):
